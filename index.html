<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DevChat Terminal</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: "Courier New", monospace;
      background-color: #2f3136;
      color: #ffffff;
    }

    /* Center the login form */
    .login-form {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #2f3136;
      position: absolute;
      z-index: 100;
    }

    .login-form input {
      margin: 10px;
      padding: 10px;
      border: 1px solid #444;
      background-color: #202225;
      color: #ffffff;
      font-size: 16px;
      width: 300px;
      border-radius: 5px;
    }

    .login-form button {
      padding: 10px 20px;
      background-color: #7289da;
      color: #ffffff;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      width: 300px;
    }

    .login-form button:hover {
      background-color: #5b6eae;
    }

    /* Terminal container */
    .terminal {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      padding: 10px;
      overflow-y: auto;
      background-color: #1e2124;
      display: none; /* Initially hidden */
      color: #ffffff;
    }

    .command-line {
      display: flex;
      margin-bottom: 10px;
    }

    .command-line input {
      background-color: #2f3136;
      border: 1px solid #444;
      color: #ffffff;
      font-size: 16px;
      padding: 8px;
      flex: 1;
      border-radius: 5px;
    }

    .command-line span {
      margin-right: 10px;
      color: #7289da;
    }

    /* Console output */
    .output {
      padding-left: 15px;
    }

    .output p {
      margin: 0;
    }

    /* Code styling */
    .code-block {
      background-color: #2c2f38;
      border: 1px solid #444;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      font-family: monospace;
      white-space: pre-wrap; /* Wrap long lines of code */
      word-wrap: break-word;
      color: #dcdcdc;
    }

    .code-block pre {
      margin: 0;
      font-size: 14px;
    }

    /* Make the layout mobile friendly */
    @media (max-width: 768px) {
      .login-form input, .login-form button {
        width: 250px;
      }

      .command-line input {
        font-size: 14px;
      }
    }

    @media (max-width: 480px) {
      .login-form input, .login-form button {
        width: 200px;
      }

      .command-line input {
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <!-- Login Form -->
  <div class="login-form" id="login-form">
    <div>
      <h1 style="color: #7289da;">Login</h1>
      <input type="email" id="email" placeholder="Email" required>
      <input type="password" id="password" placeholder="Password" required>
      <button id="login-button">Login</button>
      <p style="color: #7289da;">Don't have an account? <a href="#" id="register-link">Register</a></p>
    </div>
  </div>

  <!-- Terminal -->
  <div class="terminal" id="terminal">
    <div id="console-output" class="output"></div>
    <div class="command-line">
      <span>devchat@user:~$</span>
      <input type="text" id="command-input" placeholder="Enter command..." />
    </div>
  </div>

  <script type="module">
    // Firebase SDK imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAe8kZK1EtKX92L2Sopk5uSi2PDTzMtH6M",
      authDomain: "devchat-97f99.firebaseapp.com",
      projectId: "devchat-97f99",
      storageBucket: "devchat-97f99.firebasestorage.app",
      messagingSenderId: "778378732801",
      appId: "1:778378732801:web:2b668fa9c6a22d6a8f2700",
      measurementId: "G-5STVV3XZ0D"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Log to console function
    function logToConsole(message) {
      const consoleOutput = document.getElementById("console-output");
      const newMessage = document.createElement("p");
      newMessage.textContent = message;
      consoleOutput.appendChild(newMessage);
      consoleOutput.scrollTop = consoleOutput.scrollHeight;
    }

    // Show the terminal and hide the login form
    function showTerminal() {
      document.getElementById("login-form").style.display = "none";
      document.getElementById("terminal").style.display = "flex";
    }

    // Show the login form
    function showLoginForm() {
      document.getElementById("login-form").style.display = "flex";
      document.getElementById("terminal").style.display = "none";
    }

    // Authentication state listener
    auth.onAuthStateChanged((user) => {
      if (user) {
        logToConsole(`Logged in as: ${user.email}`);
        showTerminal(); // Switch to terminal view after login
      } else {
        logToConsole("No user is logged in.");
        showLoginForm(); // Show login form if no user is logged in
      }
    });

    // Handle login button
    document.getElementById("login-button").addEventListener("click", () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      if (!email || !password) {
        logToConsole("Please enter both email and password.");
        return;
      }

      signInWithEmailAndPassword(auth, email, password)
        .then(() => {
          logToConsole("Logged in successfully!");
        })
        .catch((error) => {
          const errorCode = error.code;
          const errorMessage = error.message;
          logToConsole(`Login Failed: ${errorCode} - ${errorMessage}`);
        });
    });

    // Register link click
    document.getElementById("register-link").addEventListener("click", (e) => {
      e.preventDefault();
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      if (!email || !password) {
        logToConsole("Please enter both email and password.");
        return;
      }

      createUserWithEmailAndPassword(auth, email, password)
        .then(() => {
          logToConsole("Registered new account successfully!");
        })
        .catch((error) => {
          const errorCode = error.code;
          const errorMessage = error.message;
          logToConsole(`Registration Failed: ${errorCode} - ${errorMessage}`);
        });
    });

    // Handle terminal input (login/register commands)
    const commandInput = document.getElementById("command-input");
    commandInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") {
        const command = commandInput.value.trim();
        logToConsole(`$ ${command}`);

        // Handle commands
        if (command.startsWith("login")) {
          const email = prompt("Enter your email:");
          const password = prompt("Enter your password:");
          signInWithEmailAndPassword(auth, email, password)
            .then(() => logToConsole("Logged in successfully!"))
            .catch((error) => logToConsole(`Login Failed: ${error.message}`));
        } else if (command.startsWith("register")) {
          const email = prompt("Enter your email:");
          const password = prompt("Enter your password:");
          createUserWithEmailAndPassword(auth, email, password)
            .then(() => logToConsole("Registered new account successfully!"))
            .catch((error) => logToConsole(`Registration Failed: ${error.message}`));
        } else if (command === "help") {
          logToConsole("Available commands: login, register, send code <code>, send [message], join [channel]");
        } else if (command.startsWith("send code")) {
          const code = command.slice(10).trim(); // Extract code after 'send code'
          logToConsole(`Sending code:`);
          const codeBlock = document.createElement("div");
          codeBlock.classList.add("code-block");
          codeBlock.textContent = code;
          document.getElementById("console-output").appendChild(codeBlock);
        } else {
          logToConsole("Unknown command. Type 'help' for a list of commands.");
        }

        commandInput.value = "";
      }
    });

    // Handle log out
    function logout() {
      signOut(auth)
        .then(() => {
          logToConsole("Logged out successfully.");
        })
        .catch((error) => {
          logToConsole(`Logout Failed: ${error.message}`);
        });
    }

    // Example of logging out after a period
    setTimeout(logout, 600000); // Log out after 10 minutes (600000 ms)
  </script>
</body>
</html>